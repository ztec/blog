<!DOCTYPE html>
<html lang="{{ $.Page.Language.Lang| default "en" }}">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    {{/* NOTE: the Site's title, and if there is a page title, that is set too */}}
    <title>{{ block "title" . }}{{ with .Params.Title }}{{ . }} | {{ end }}{{ .Site.Title }}{{ end }}</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{if .IsPage}}{{ .Summary }}{{ else }}{{ with .Site.Params.description }}{{ . }}{{ end }}{{ end }}{{ end }}">
    {{/* NOTE: For Production make sure you add `HUGO_ENV="production"` before your build command */}}
    {{ if eq (getenv "HUGO_ENV") "production" | or (eq .Site.Params.env "production")  }}
      <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
    {{ else }}
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    {{ end }}

    {{ partial "site-style.html" . }}

    {{ block "favicon" . }}
      {{ partialCached "site-favicon.html" . }}
    {{ end }}



    <link href="/index.xml" rel="alternate" type="application/rss+xml" title="{{ $.Site.Title }} Français" />
    <link href="/index.xml" rel="feed" type="application/rss+xml" title="{{ $.Site.Title }} Français" />

    <link href="/en/index.xml" rel="alternate" type="application/rss+xml" title="{{ $.Site.Title }} English" />
    <link href="/en/index.xml" rel="feed" type="application/rss+xml" title="{{ $.Site.Title }}  English" />

    <link rel="me" href="https://mamot.fr/@ztec">

    {{ if .OutputFormats.Get "RSS" }}
    {{ with .OutputFormats.Get "RSS" }}
      <link href="{{ .RelPermalink }}" rel="alternate" type="application/rss+xml" title="{{ $.Site.Title }}" />
      <link href="{{ .RelPermalink }}" rel="feed" type="application/rss+xml" title="{{ $.Site.Title }}" />
      {{ end }}
    {{ end }}

    {{/* NOTE: These Hugo Internal Templates can be found starting at https://github.com/gohugoio/hugo/tree/master/tpl/tplimpl/embedded/templates */}}
    {{- template "_internal/opengraph.html" . -}}
    {{- template "_internal/schema.html" . -}}
    {{- template "_internal/twitter_cards.html" . -}}

	{{ block "head" . }}{{ partial "head-additions.html" . }}{{ end }}
  </head>

  <body class="ma0 {{ $.Param "body_classes"  | default "avenir bg-near-white"}}{{ with getenv "HUGO_ENV" }} {{ . }}{{ end }}">
    <div id="modeChanger" class="modeChanger">
        <input id="on" name="mode" type="radio" checked="" />
        <label for="on" onclick="setBody('dark')">Dark</label>

        <input id="auto" name="mode" type="radio" checked="checked" />
        <label for="auto" class="disabled" onclick="setBody('auto')">auto</label>

        <input id="off" name="mode" type="radio" />
        <label for="off" onclick="setBody('light')">Light</label>
    </div>
    <script>


        var possibleModes = ["auto","dark","light"];
        var currentMode = 0
        /* Handle dark/light mode auto & memory */
        var savedMode = localStorage.getItem("mode")
        var osMode = 'light'
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            osMode = 'dark'
        }


        function setBody(mode){

            saveMode(mode)
            if (mode == 'auto'){
              mode = osMode
            }
            if (mode === 'dark') {
                window.document.body.classList.replace('z-theme-light', '.z-theme-dark')
                window.document.body.classList.add('z-theme-dark')
            }else if (mode==='light') {
                window.document.body.classList.replace('z-theme-dark', '.z-theme-light')
                window.document.body.classList.add('z-theme-light')
            }
        }

        function saveMode(mode){
          if (mode === "auto"){
            localStorage.removeItem('mode')
          }else{
            localStorage.setItem('mode', mode)
          }
        }

      if ( savedMode === 'light' || savedMode === 'dark' ){
          setBody(savedMode)
          currentMode = possibleModes.indexOf(savedMode)
      }else {
          setBody(osMode)
      }

      function toggleMode(){
          currentMode++
          if (currentMode >= possibleModes.length ){
              currentMode = 0
          }
          setBody(possibleModes[currentMode])
          saveMode(possibleModes[currentMode])
      }

    </script>

    {{ block "header" . }}{{ partial "site-header.html" .}}{{ end }}
    <main class="pb7  " role="main">
      {{ block "main" . }}{{ end }}
    </main>
    {{ block "footer" . }}{{ partialCached "site-footer.html" . }}{{ end }}

    <script>
      /* QuickFix, /TODO need a proper fix */
      var links = document.getElementsByTagName("a");
      for (var i = 0, linksLength = links.length; i < linksLength; i++) {
        if (links[i].hostname !== window.location.hostname && !links[i].target) {
          links[i].target = '_blank';
        }
      }
    </script>
  </body>
</html>